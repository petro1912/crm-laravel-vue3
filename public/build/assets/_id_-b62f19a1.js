import{m as xe,b as Se,u as Ce,c as ne,f as ke,d as ye,e as De,a as Pe}from"./VTextField-3871db8a.js";import{N as we,Q as he,G as $,j as v,a2 as le,D as B,ac as Re,S as Ie,a6 as Ue,n as e,H as Z,F as O,I as ue,ad as $e,ae as Ae,a7 as ee,a8 as Fe,af as Ne,ag as Be,d as He,ah as re,o as T,c as ce,p as t,b as q,A as Me,aa as Te,a as me,w as o,m as je,ai as ie,aj as de,q as ze,a1 as Le,L as J,C as P,E as K,x as E,l as M,s as Ge,ak as Ee}from"./main-b6631041.js";import{I as Je}from"./VImg-06128a7e.js";import{f as Oe}from"./forwardRefs-813ef531.js";import{_ as fe}from"./AppSelect-44a9289a.js";import{V as ae,_ as qe}from"./VSnackbar-16d59590.js";import{_ as Ke}from"./DialogCloseBtn-ee7411af.js";import{k as Qe,s as b,f as We}from"./auth-368f15e6.js";import{b as G,a as te}from"./axios-d67b4108.js";import{V as pe,d as Q,b as Xe,a as Ye}from"./VCard-e5479f5c.js";import{V as C,a as p}from"./VRow-54a5ce54.js";import{V as Ze}from"./VDialog-2503be7a.js";import{V as et}from"./VDivider-38ac4951.js";import"./transition-1cb87bca.js";import"./VSelect-806fbf7a.js";import"./VList-29aa2d2e.js";import"./VAvatar-58f9d872.js";import"./dialog-transition-0b2641ee.js";import"./VMenu-f6e2ae7c.js";import"./VCheckboxBtn-e4ec367e.js";const tt=we()({name:"VTextarea",directives:{Intersect:Je},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:a=>!isNaN(parseFloat(a))},maxRows:{type:[Number,String],validator:a=>!isNaN(parseFloat(a))},suffix:String,modelModifiers:Object,...xe(),...Se()},emits:{"click:control":a=>!0,"mousedown:control":a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0},setup(a,I){let{attrs:k,emit:g,slots:d}=I;const s=he(a,"modelValue"),{isFocused:V,focus:y,blur:D}=Ce(a),w=$(()=>typeof a.counterValue=="function"?a.counterValue(s.value):(s.value||"").toString().length),x=$(()=>{if(k.maxlength)return k.maxlength;if(!(!a.counter||typeof a.counter!="number"&&typeof a.counter!="string"))return a.counter});function A(c,S){var _,R;!a.autofocus||!c||(R=(_=S[0].target)==null?void 0:_.focus)==null||R.call(_)}const H=v(),U=v(),F=v(""),h=v(),j=$(()=>V.value||a.persistentPlaceholder);function N(){var c;h.value!==document.activeElement&&((c=h.value)==null||c.focus()),V.value||y()}function i(c){N(),g("click:control",c)}function l(c){g("mousedown:control",c)}function r(c){c.stopPropagation(),N(),ee(()=>{s.value="",Fe(a["onClick:clear"],c)})}function u(c){var _;const S=c.target;if(s.value=S.value,(_=a.modelModifiers)!=null&&_.trim){const R=[S.selectionStart,S.selectionEnd];ee(()=>{S.selectionStart=R[0],S.selectionEnd=R[1]})}}const m=v();function n(){a.autoGrow&&ee(()=>{if(!m.value||!U.value)return;const c=getComputedStyle(m.value),S=getComputedStyle(U.value.$el),_=parseFloat(c.getPropertyValue("--v-field-padding-top"))+parseFloat(c.getPropertyValue("--v-input-padding-top"))+parseFloat(c.getPropertyValue("--v-field-padding-bottom")),R=m.value.scrollHeight,W=parseFloat(c.lineHeight),X=Math.max(parseFloat(a.rows)*W+_,parseFloat(S.getPropertyValue("--v-input-control-height"))),Y=parseFloat(a.maxRows)*W+_||1/0;F.value=Ne(Be(R??0,X,Y))})}le(n),B(s,n),B(()=>a.rows,n),B(()=>a.maxRows,n),B(()=>a.density,n);let f;return B(m,c=>{c?(f=new ResizeObserver(n),f.observe(m.value)):f==null||f.disconnect()}),Re(()=>{f==null||f.disconnect()}),Ie(()=>{const c=!!(d.counter||a.counter||a.counterValue),S=!!(c||d.details),[_,R]=Ue(k),[{modelValue:W,...X}]=ne.filterProps(a),[Y]=ke(a);return e(ne,Z({ref:H,modelValue:s.value,"onUpdate:modelValue":z=>s.value=z,class:["v-textarea v-text-field",{"v-textarea--prefixed":a.prefix,"v-textarea--suffixed":a.suffix,"v-text-field--prefixed":a.prefix,"v-text-field--suffixed":a.suffix,"v-textarea--auto-grow":a.autoGrow,"v-textarea--no-resize":a.noResize||a.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(a.variant)},a.class],style:a.style},_,X,{focused:V.value}),{...d,default:z=>{let{isDisabled:L,isDirty:oe,isReadonly:ge,isValid:ve}=z;return e(ye,Z({ref:U,style:{"--v-textarea-control-height":F.value},onClick:i,onMousedown:l,"onClick:clear":r,"onClick:prependInner":a["onClick:prependInner"],"onClick:appendInner":a["onClick:appendInner"],role:"textbox"},Y,{active:j.value||oe.value,dirty:oe.value||a.dirty,disabled:L.value,focused:V.value,error:ve.value===!1}),{...d,default:Ve=>{let{props:{class:se,...be}}=Ve;return e(O,null,[a.prefix&&e("span",{class:"v-text-field__prefix"},[a.prefix]),ue(e("textarea",Z({ref:h,class:se,value:s.value,onInput:u,autofocus:a.autofocus,readonly:ge.value,disabled:L.value,placeholder:a.placeholder,rows:a.rows,name:a.name,onFocus:N,onBlur:D},be,R),null),[[$e("intersect"),{handler:A},null,{once:!0}]]),a.autoGrow&&ue(e("textarea",{class:[se,"v-textarea__sizer"],"onUpdate:modelValue":_e=>s.value=_e,ref:m,readonly:!0,"aria-hidden":"true"},null),[[Ae,s.value]]),a.suffix&&e("span",{class:"v-text-field__suffix"},[a.suffix])])}})},details:S?z=>{var L;return e(O,null,[(L=d.details)==null?void 0:L.call(d,z),c&&e(O,null,[e("span",null,null),e(De,{active:a.persistentCounter||V.value,value:w.value,max:x.value},d.counter)])])}:void 0})}),Oe({},H,U,h)}}),at=He({name:"AppTextarea",inheritAttrs:!1}),lt=Object.assign(at,{setup(a){const I=$(()=>{const g=re(),d=g.id||g.label;return d?`app-textarea-${d}-${Math.random().toString(36).slice(2,7)}`:void 0}),k=$(()=>re().label);return(g,d)=>(T(),ce("div",{class:ze(["app-textarea flex-grow-1",g.$attrs.class])},[t(k)?(T(),q(Pe,{key:0,for:t(I),class:"mb-1 text-body-2 text-high-emphasis",text:t(k)},null,8,["for","text"])):Me("",!0),e(tt,ie(de({...g.$attrs,class:null,label:void 0,variant:"outlined",id:t(I)})),Te({_:2},[me(g.$slots,(s,V)=>({name:V,fn:o(y=>[je(g.$slots,V,ie(de(y||{})))])}))]),1040)],2))}}),ot={__name:"SubmitDialog",props:{isDialogVisible:{type:Boolean,required:!0}},emits:["close-dialog","update-record"],setup(a,{emit:I}){const k=a,g="https://ktic.com.my/api",d=Le(k,"isDialogVisible"),s=v(Qe),V=v([]),y=v([]),D=v([]),w=v([]),x=$(()=>A.value.length>0),A=v(""),H=()=>{I("close-dialog")};B(()=>s.value.product,(i,l)=>{i!=l&&j()},{deep:!0}),B(()=>s.value.state,(i,l)=>{i!=l&&F()},{deep:!0});const U=()=>{const i={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1"};G.get(`${g}/api_state_list.php`,{params:i}).then(l=>{const r=l.data;r.error?V.value=[]:V.value=r.map(u=>u.state_name)})},F=()=>{const i={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",state_name:s.value.state};G.get(`${g}/api_area_list.php`,{params:i}).then(l=>{const r=l.data;r.error?y.value=[]:y.value=r.map(u=>u.area)})},h=()=>{const i={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1"};G.get(`${g}/api_available_products.php`,{params:i}).then(l=>{const r=l.data;r.error?D.value=[]:D.value=r.map(u=>u.product_name)})},j=()=>{const i={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",product_name:s.value.product};G.get(`${g}/api_available_package.php`,{params:i}).then(l=>{const r=l.data;r.error?w.value=[]:w.value=r.map(u=>u.package_name)})},N=()=>{const i=s.value;for(const r of Object.keys(i))if(console.log(r),i[r]==""||!i[r]){A.value=`'${b[r]}' must not be empty!`;return}const l={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",product_name:i.product,package_name:i.package,customer_name:i.fullname,nric:i.nric,citizen:i.citizen,address:`${i.address1} ${i.address2} ${i.address3}`,postcode:i.postcode,state_name:i.state,contact:i.contact,email:i.email,agentcode:i.agentcode};G.post(`${g}/casecrm_submitorder.php`,l).then(r=>{console.log("res",r)})};return le(()=>{U(),h()}),(i,l)=>{const r=Ke,u=fe,m=qe;return T(),q(Ze,{modelValue:t(d),"onUpdate:modelValue":l[16]||(l[16]=n=>K(d)?d.value=n:null),persistent:"","max-width":"720"},{default:o(()=>[e(r,{onClick:H}),e(pe,{title:"Submit to KTIC"},{default:o(()=>[e(Q,null,{default:o(()=>[e(C,{class:"mx-2"},{default:o(()=>[e(p,null,{default:o(()=>[e(u,{items:t(D),modelValue:t(s).product,"onUpdate:modelValue":l[0]||(l[0]=n=>t(s).product=n),label:t(b).product},null,8,["items","modelValue","label"])]),_:1}),e(p,null,{default:o(()=>[e(u,{items:t(w),modelValue:t(s).package,"onUpdate:modelValue":l[1]||(l[1]=n=>t(s).package=n),label:t(b).package},null,8,["items","modelValue","label"])]),_:1})]),_:1}),e(C,{class:"mx-2"},{default:o(()=>[e(p,null,{default:o(()=>[e(m,{modelValue:t(s).fullname,"onUpdate:modelValue":l[2]||(l[2]=n=>t(s).fullname=n),label:t(b).fullname},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:o(()=>[e(m,{modelValue:t(s).passportNo,"onUpdate:modelValue":l[3]||(l[3]=n=>t(s).passportNo=n),label:t(b).passportNo},null,8,["modelValue","label"])]),_:1})]),_:1}),e(C,{class:"mx-2"},{default:o(()=>[e(p,null,{default:o(()=>[e(u,{items:t(V),modelValue:t(s).state,"onUpdate:modelValue":l[4]||(l[4]=n=>t(s).state=n),label:t(b).state},null,8,["items","modelValue","label"])]),_:1}),e(p,null,{default:o(()=>[e(m,{modelValue:t(s).address1,"onUpdate:modelValue":l[5]||(l[5]=n=>t(s).address1=n),label:t(b).address1},null,8,["modelValue","label"])]),_:1})]),_:1}),e(C,{class:"mx-2"},{default:o(()=>[e(p,null,{default:o(()=>[e(u,{items:t(y),modelValue:t(s).area,"onUpdate:modelValue":l[6]||(l[6]=n=>t(s).area=n),label:t(b).area},null,8,["items","modelValue","label"])]),_:1}),e(p,null,{default:o(()=>[e(m,{modelValue:t(s).address2,"onUpdate:modelValue":l[7]||(l[7]=n=>t(s).address2=n),label:t(b).address2},null,8,["modelValue","label"])]),_:1})]),_:1}),e(C,{class:"mx-2"},{default:o(()=>[e(p,null,{default:o(()=>[e(m,{modelValue:t(s).postcode,"onUpdate:modelValue":l[8]||(l[8]=n=>t(s).postcode=n),label:t(b).postcode},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:o(()=>[e(m,{modelValue:t(s).address3,"onUpdate:modelValue":l[9]||(l[9]=n=>t(s).address3=n),label:t(b).address3},null,8,["modelValue","label"])]),_:1})]),_:1}),e(C,{class:"mx-2"},{default:o(()=>[e(p,null,{default:o(()=>[e(m,{modelValue:t(s).contact,"onUpdate:modelValue":l[10]||(l[10]=n=>t(s).contact=n),label:t(b).contact},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:o(()=>[e(m,{modelValue:t(s).email,"onUpdate:modelValue":l[11]||(l[11]=n=>t(s).email=n),label:t(b).email},null,8,["modelValue","label"])]),_:1})]),_:1}),e(C,{class:"mx-2"},{default:o(()=>[e(p,null,{default:o(()=>[e(m,{modelValue:t(s).citizen,"onUpdate:modelValue":l[12]||(l[12]=n=>t(s).citizen=n),label:t(b).citizen},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:o(()=>[e(m,{modelValue:t(s).agentcode,"onUpdate:modelValue":l[13]||(l[13]=n=>t(s).agentcode=n),label:t(b).agentcode},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(Q,{class:"d-flex justify-end flex-wrap gap-3"},{default:o(()=>[e(J,{variant:"tonal",color:"secondary",onClick:l[14]||(l[14]=n=>d.value=!1)},{default:o(()=>[P(" Close ")]),_:1}),e(J,{onClick:N},{default:o(()=>[P(" Submit ")]),_:1})]),_:1}),e(ae,{modelValue:t(x),"onUpdate:modelValue":l[15]||(l[15]=n=>K(x)?x.value=n:null),timeout:1e3,location:"top end",color:"error"},{default:o(()=>[P(E(t(A)),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])}}},st={class:"font-italic"},nt=M("b",null,"Campaign Detail ID:",-1),ut={class:"ml-2 text-primary"},rt={class:"font-weight-bold text-sm"},it=M("div",{class:"font-italic font-weight-bold"}," Update Status ",-1),It={__name:"[id]",props:{date_filter:{type:String,required:!1}},setup(a){const I=Ge(),k=Ee(),g=parseInt(k.params.id),d=v({}),s=v(!1),V=v([]),y=v([]),D=v(!1),w=$(()=>x.value.length>0),x=v(""),A=We.campaignDetail.filter(r=>r.key!="id"&&r.key!="campaignAgentRemark"),H=()=>{s.value=!0},U=()=>{s.value=!1},F=r=>r.map(u=>({value:u.id,title:u.name,parent:u.parent_id})),h=$(()=>{const r=d.value.progressStatus;return r==null?[]:y.value.filter(u=>u.parent==r)}),j=()=>{I.back()},N=()=>{te.get("/admin/progress-categories").then(r=>{const{data:u}=r.data;V.value=F(u.categories),y.value=F(u.sub_categories)})},i=()=>{te.get(`/campaign-detail/${g}`).then(r=>{const{campaign_detail:u}=r.data;d.value=u})},l=()=>{let{progressStatus:r,progressSubStatus:u,campaignAgentRemark:m}=d.value;if(!r||r==""){x.value="Progress Status must not be empty!";return}if(!u||u==""){x.value="Progress Sub Status must not be empty!";return}if(!m||m==""){x.value="Progress Sub Status must not be empty!";return}r=V.value.find(n=>n.value==r).title,u=h.value.find(n=>n.value==u).title,te.put(`/campaign-detail/${g}`,{progressStatus:r,progressSubStatus:u,campaignAgentRemark:m}).then(n=>{const{status:f}=n.data;f=="success"&&(D.value=!0)})};return le(()=>{i(),N()}),(r,u)=>{const m=fe,n=lt;return T(),q(pe,null,{default:o(()=>[e(Ye,null,{append:o(()=>[e(J,{class:"mr-4 my-4",color:"error",onClick:j},{default:o(()=>[P(" Return ")]),_:1}),e(J,{onClick:H},{default:o(()=>[P(" Submit ")]),_:1})]),default:o(()=>[e(Xe,null,{default:o(()=>[P("Campaign Detail")]),_:1})]),_:1}),e(Q,{class:"pl-8"},{default:o(()=>[e(C,null,{default:o(()=>[e(p,{cols:"12"},{default:o(()=>[M("div",st,[nt,P(),M("span",ut," #"+E(t(d).id),1)])]),_:1})]),_:1}),e(C,null,{default:o(()=>[(T(!0),ce(O,null,me(t(A),(f,c)=>(T(),q(p,{cols:"4",key:c,class:"d-flex justify-between"},{default:o(()=>[M("div",rt,E(f.title)+":",1),M("div",null,E(t(d)[f.key]||"--"),1)]),_:2},1024))),128))]),_:1}),e(et,{class:"my-6"}),e(C,null,{default:o(()=>[e(p,{cols:"12"},{default:o(()=>[it]),_:1})]),_:1}),e(C,null,{default:o(()=>[e(p,{cols:"6"},{default:o(()=>[e(m,{modelValue:t(d).progressStatus,"onUpdate:modelValue":u[0]||(u[0]=f=>t(d).progressStatus=f),items:t(V),label:"Progress Status"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"6"},{default:o(()=>[e(m,{modelValue:t(d).progressSubStatus,"onUpdate:modelValue":u[1]||(u[1]=f=>t(d).progressSubStatus=f),items:t(h),label:"Progress Sub Status"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12"},{default:o(()=>[e(n,{modelValue:t(d).campaignAgentRemark,"onUpdate:modelValue":u[2]||(u[2]=f=>t(d).campaignAgentRemark=f),label:"Campaign Agent Remark"},null,8,["modelValue"])]),_:1})]),_:1}),e(Q,{class:"d-flex justify-end flex-wrap gap-3"},{default:o(()=>[e(J,{onClick:l},{default:o(()=>[P(" Update ")]),_:1})]),_:1}),e(ae,{modelValue:t(w),"onUpdate:modelValue":u[3]||(u[3]=f=>K(w)?w.value=f:null),timeout:1e3,location:"top end",color:"error"},{default:o(()=>[P(E(t(x)),1)]),_:1},8,["modelValue"]),e(ae,{modelValue:t(D),"onUpdate:modelValue":u[4]||(u[4]=f=>K(D)?D.value=f:null),timeout:1e3,location:"top end",color:"error"},{default:o(()=>[P(" Status has been successfully updated. ")]),_:1},8,["modelValue"])]),_:1}),e(ot,{isDialogVisible:t(s),onCloseDialog:U},null,8,["isDialogVisible"])]),_:1})}}};export{It as default};
