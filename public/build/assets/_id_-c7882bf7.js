import{m as Se,b as ke,u as ye,c as ne,f as Ce,d as De,e as Ue,a as we}from"./VTextField-33a062f4.js";import{N as Re,Q as Ie,G as A,j as b,a2 as le,D as T,ac as Pe,S as he,a6 as Ne,n as e,H as ee,F as q,I as ue,ad as $e,ae as Ae,a7 as ae,a8 as Fe,af as Be,ag as Me,d as Te,ah as re,o as L,c as me,p as a,b as K,A as ce,aa as He,a as fe,w as n,m as je,ai as ie,aj as de,q as Le,a1 as ze,L as O,C,E as Y,x as j,l as $,s as Ee,ak as Ge}from"./main-ba954960.js";import{I as Oe}from"./VImg-cfd5b846.js";import{f as Je}from"./forwardRefs-9c8cfe26.js";import{_ as pe}from"./AppSelect-4ea30f7a.js";import{V as te,_ as qe}from"./VSnackbar-c7b05951.js";import{_ as Ke}from"./DialogCloseBtn-7aeb1939.js";import{k as Ye,s as v,G as Qe,l as We,Y as Xe,f as Ze}from"./auth-6f71121d.js";import{b as G,a as J}from"./axios-92953ab3.js";import{V as ge,d as Q,b as ea,a as aa}from"./VCard-4d0186bd.js";import{V as _,a as f}from"./VRow-7a47c5d5.js";import{V as ta}from"./VDialog-e4ed048c.js";import{V as la}from"./VDivider-d0778b72.js";import"./transition-c7299037.js";import"./VSelect-62ecfe7f.js";import"./VList-8a00952c.js";import"./VAvatar-76d73489.js";import"./VMenu-40c07e5e.js";import"./VCheckboxBtn-9b8ab3ee.js";const oa=Re()({name:"VTextarea",directives:{Intersect:Oe},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:u=>!isNaN(parseFloat(u))},maxRows:{type:[Number,String],validator:u=>!isNaN(parseFloat(u))},suffix:String,modelModifiers:Object,...Se(),...ke()},emits:{"click:control":u=>!0,"mousedown:control":u=>!0,"update:focused":u=>!0,"update:modelValue":u=>!0},setup(u,w){let{attrs:D,emit:g,slots:m}=w;const l=Ie(u,"modelValue"),{isFocused:V,focus:y,blur:S}=ye(u),R=A(()=>typeof u.counterValue=="function"?u.counterValue(l.value):(l.value||"").toString().length),U=A(()=>{if(D.maxlength)return D.maxlength;if(!(!u.counter||typeof u.counter!="number"&&typeof u.counter!="string"))return u.counter});function h(r,x){var k,P;!u.autofocus||!r||(P=(k=x[0].target)==null?void 0:k.focus)==null||P.call(k)}const F=b(),N=b(),B=b(""),I=b(),H=A(()=>V.value||u.persistentPlaceholder);function M(){var r;I.value!==document.activeElement&&((r=I.value)==null||r.focus()),V.value||y()}function d(r){M(),g("click:control",r)}function o(r){g("mousedown:control",r)}function c(r){r.stopPropagation(),M(),ae(()=>{l.value="",Fe(u["onClick:clear"],r)})}function i(r){var k;const x=r.target;if(l.value=x.value,(k=u.modelModifiers)!=null&&k.trim){const P=[x.selectionStart,x.selectionEnd];ae(()=>{x.selectionStart=P[0],x.selectionEnd=P[1]})}}const s=b();function t(){u.autoGrow&&ae(()=>{if(!s.value||!N.value)return;const r=getComputedStyle(s.value),x=getComputedStyle(N.value.$el),k=parseFloat(r.getPropertyValue("--v-field-padding-top"))+parseFloat(r.getPropertyValue("--v-input-padding-top"))+parseFloat(r.getPropertyValue("--v-field-padding-bottom")),P=s.value.scrollHeight,W=parseFloat(r.lineHeight),X=Math.max(parseFloat(u.rows)*W+k,parseFloat(x.getPropertyValue("--v-input-control-height"))),Z=parseFloat(u.maxRows)*W+k||1/0;B.value=Be(Me(P??0,X,Z))})}le(t),T(l,t),T(()=>u.rows,t),T(()=>u.maxRows,t),T(()=>u.density,t);let p;return T(s,r=>{r?(p=new ResizeObserver(t),p.observe(s.value)):p==null||p.disconnect()}),Pe(()=>{p==null||p.disconnect()}),he(()=>{const r=!!(m.counter||u.counter||u.counterValue),x=!!(r||m.details),[k,P]=Ne(D),[{modelValue:W,...X}]=ne.filterProps(u),[Z]=Ce(u);return e(ne,ee({ref:F,modelValue:l.value,"onUpdate:modelValue":z=>l.value=z,class:["v-textarea v-text-field",{"v-textarea--prefixed":u.prefix,"v-textarea--suffixed":u.suffix,"v-text-field--prefixed":u.prefix,"v-text-field--suffixed":u.suffix,"v-textarea--auto-grow":u.autoGrow,"v-textarea--no-resize":u.noResize||u.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(u.variant)},u.class],style:u.style},k,X,{focused:V.value}),{...m,default:z=>{let{isDisabled:E,isDirty:oe,isReadonly:ve,isValid:Ve}=z;return e(De,ee({ref:N,style:{"--v-textarea-control-height":B.value},onClick:d,onMousedown:o,"onClick:clear":c,"onClick:prependInner":u["onClick:prependInner"],"onClick:appendInner":u["onClick:appendInner"],role:"textbox"},Z,{active:H.value||oe.value,dirty:oe.value||u.dirty,disabled:E.value,focused:V.value,error:Ve.value===!1}),{...m,default:be=>{let{props:{class:se,..._e}}=be;return e(q,null,[u.prefix&&e("span",{class:"v-text-field__prefix"},[u.prefix]),ue(e("textarea",ee({ref:I,class:se,value:l.value,onInput:i,autofocus:u.autofocus,readonly:ve.value,disabled:E.value,placeholder:u.placeholder,rows:u.rows,name:u.name,onFocus:M,onBlur:S},_e,P),null),[[$e("intersect"),{handler:h},null,{once:!0}]]),u.autoGrow&&ue(e("textarea",{class:[se,"v-textarea__sizer"],"onUpdate:modelValue":xe=>l.value=xe,ref:s,readonly:!0,"aria-hidden":"true"},null),[[Ae,l.value]]),u.suffix&&e("span",{class:"v-text-field__suffix"},[u.suffix])])}})},details:x?z=>{var E;return e(q,null,[(E=m.details)==null?void 0:E.call(m,z),r&&e(q,null,[e("span",null,null),e(Ue,{active:u.persistentCounter||V.value,value:R.value,max:U.value},m.counter)])])}:void 0})}),Je({},F,N,I)}}),sa=Te({name:"AppTextarea",inheritAttrs:!1}),na=Object.assign(sa,{setup(u){const w=A(()=>{const g=re(),m=g.id||g.label;return m?`app-textarea-${m}-${Math.random().toString(36).slice(2,7)}`:void 0}),D=A(()=>re().label);return(g,m)=>(L(),me("div",{class:Le(["app-textarea flex-grow-1",g.$attrs.class])},[a(D)?(L(),K(we,{key:0,for:a(w),class:"mb-1 text-body-2 text-high-emphasis",text:a(D)},null,8,["for","text"])):ce("",!0),e(oa,ie(de({...g.$attrs,class:null,label:void 0,variant:"outlined",id:a(w)})),He({_:2},[fe(g.$slots,(l,V)=>({name:V,fn:n(y=>[je(g.$slots,V,ie(de(y||{})))])}))]),1040)],2))}}),ua={__name:"SubmitDialog",props:{isDialogVisible:{type:Boolean,required:!0}},emits:["close-dialog","update-record"],setup(u,{emit:w}){const D=u,g="https://ktic.com.my/api",m=ze(D,"isDialogVisible"),l=b(Ye),V=b([]),y=b([]),S=b([]),R=b([]),U=A(()=>h.value.length>0),h=b(""),F=()=>{w("close-dialog")};T(()=>l.value.product,(d,o)=>{d!=o&&H()},{deep:!0}),T(()=>l.value.state,(d,o)=>{d!=o&&B()},{deep:!0});const N=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1"};G.get(`${g}/api_state_list.php`,{params:d}).then(o=>{const c=o.data;c.error?V.value=[]:V.value=c.map(i=>i.state_name)})},B=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",state_name:l.value.state};G.get(`${g}/api_area_list.php`,{params:d}).then(o=>{const c=o.data;c.error?y.value=[]:y.value=c.map(i=>i.area)})},I=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1"};G.get(`${g}/api_available_products.php`,{params:d}).then(o=>{const c=o.data;c.error?S.value=[]:S.value=c.map(i=>i.product_name)})},H=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",product_name:l.value.product};G.get(`${g}/api_available_package.php`,{params:d}).then(o=>{const c=o.data;c.error?R.value=[]:R.value=c.map(i=>i.package_name)})},M=()=>{const d=l.value;for(const c of Object.keys(d))if(c!="address3"&&c!="remark"&&(d[c]==""||!d[c])){h.value=`'${v[c]}' must not be empty!`;return}const o={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",product_name:d.product,package_name:d.package,customer_name:d.fullname,nric:d.nric,citizen:d.citizen,address:`${d.address1} ${d.address2} ${d.address3}`,postcode:d.postcode,state_name:d.state,area:d.area,contact:d.contact,email:d.email,agentcode:d.agentcode,gender:d.gender,race:d.race,existing_unifi:d.existingUnifi,alt_num:d.altNum,remark:d.remark};G.post(`${g}/casecrm_submitorder.php`,new URLSearchParams(o).toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(c=>{const i=c.data;if(i instanceof Array){const s=i[0];if(s.status==0){delete s.status;const t=Object.keys(s)[0];h.value=s[t]}else s.status==1&&s.ref_number&&w("update-record",s.ref_number)}})};return le(()=>{N(),I()}),(d,o)=>{const c=Ke,i=pe,s=qe;return L(),K(ta,{modelValue:a(m),"onUpdate:modelValue":o[20]||(o[20]=t=>Y(m)?m.value=t:null),persistent:"","max-width":"720"},{default:n(()=>[e(c,{onClick:F}),e(ge,{title:"Submit to KTIC"},{default:n(()=>[e(Q,null,{default:n(()=>[e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(i,{items:a(S),modelValue:a(l).product,"onUpdate:modelValue":o[0]||(o[0]=t=>a(l).product=t),label:a(v).product},null,8,["items","modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(i,{items:a(R),modelValue:a(l).package,"onUpdate:modelValue":o[1]||(o[1]=t=>a(l).package=t),label:a(v).package},null,8,["items","modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(i,{items:a(Qe),modelValue:a(l).gender,"onUpdate:modelValue":o[2]||(o[2]=t=>a(l).gender=t),label:a(v).gender},null,8,["items","modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(i,{items:a(We),modelValue:a(l).race,"onUpdate:modelValue":o[3]||(o[3]=t=>a(l).race=t),label:a(v).race},null,8,["items","modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(s,{items:a(S),modelValue:a(l).altNum,"onUpdate:modelValue":o[4]||(o[4]=t=>a(l).altNum=t),label:a(v).altNum},null,8,["items","modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(i,{items:a(Xe),modelValue:a(l).existingUnifi,"onUpdate:modelValue":o[5]||(o[5]=t=>a(l).existingUnifi=t),label:a(v).existingUnifi},null,8,["items","modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(s,{modelValue:a(l).fullname,"onUpdate:modelValue":o[6]||(o[6]=t=>a(l).fullname=t),label:a(v).fullname},null,8,["modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(s,{modelValue:a(l).nric,"onUpdate:modelValue":o[7]||(o[7]=t=>a(l).nric=t),label:a(v).nric},null,8,["modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(i,{items:a(V),modelValue:a(l).state,"onUpdate:modelValue":o[8]||(o[8]=t=>a(l).state=t),label:a(v).state},null,8,["items","modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(s,{modelValue:a(l).address1,"onUpdate:modelValue":o[9]||(o[9]=t=>a(l).address1=t),label:a(v).address1},null,8,["modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(i,{items:a(y),modelValue:a(l).area,"onUpdate:modelValue":o[10]||(o[10]=t=>a(l).area=t),label:a(v).area},null,8,["items","modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(s,{modelValue:a(l).address2,"onUpdate:modelValue":o[11]||(o[11]=t=>a(l).address2=t),label:a(v).address2},null,8,["modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(s,{modelValue:a(l).postcode,"onUpdate:modelValue":o[12]||(o[12]=t=>a(l).postcode=t),label:a(v).postcode},null,8,["modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(s,{modelValue:a(l).address3,"onUpdate:modelValue":o[13]||(o[13]=t=>a(l).address3=t),label:a(v).address3},null,8,["modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(s,{modelValue:a(l).contact,"onUpdate:modelValue":o[14]||(o[14]=t=>a(l).contact=t),label:a(v).contact},null,8,["modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(s,{modelValue:a(l).email,"onUpdate:modelValue":o[15]||(o[15]=t=>a(l).email=t),label:a(v).email},null,8,["modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(s,{modelValue:a(l).citizen,"onUpdate:modelValue":o[16]||(o[16]=t=>a(l).citizen=t),label:a(v).citizen},null,8,["modelValue","label"])]),_:1}),e(f,null,{default:n(()=>[e(s,{modelValue:a(l).agentcode,"onUpdate:modelValue":o[17]||(o[17]=t=>a(l).agentcode=t),label:a(v).agentcode},null,8,["modelValue","label"])]),_:1})]),_:1}),e(_,{class:"mx-2"},{default:n(()=>[e(f,null,{default:n(()=>[e(s,{modelValue:a(l).remark,"onUpdate:modelValue":o[18]||(o[18]=t=>a(l).remark=t),label:a(v).remark},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(Q,{class:"d-flex justify-end flex-wrap gap-3"},{default:n(()=>[e(O,{variant:"tonal",color:"secondary",onClick:F},{default:n(()=>[C(" Close ")]),_:1}),e(O,{onClick:M},{default:n(()=>[C(" Submit ")]),_:1})]),_:1}),e(te,{modelValue:a(U),"onUpdate:modelValue":o[19]||(o[19]=t=>Y(U)?U.value=t:null),timeout:1e3,location:"top end",color:"error"},{default:n(()=>[C(j(a(h)),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])}}},ra={class:"font-italic"},ia=$("b",null,"Campaign Detail ID: ",-1),da={class:"mx-2 text-primary"},ma=$("b",null,"Campaign Reference Number: ",-1),ca={class:"ml-2 text-primary"},fa={class:"font-weight-bold text-sm"},pa=$("div",{class:"font-italic font-weight-bold"}," Update Status ",-1),Aa={__name:"[id]",props:{date_filter:{type:String,required:!1}},setup(u){const w=Ee(),D=Ge(),g=parseInt(D.params.id),m=b({}),l=b(!1),V=b([]),y=b([]),S=b(!1),R=A(()=>U.value.length>0),U=b(""),h=Ze.campaignDetail.filter(i=>i.key!="id"&&i.key!="campaignAgentRemark"),F=()=>{l.value=!0},N=()=>{l.value=!1},B=i=>i.map(s=>({value:s.id,title:s.name,parent:s.parent_id})),I=A(()=>{const i=m.value.progressStatus,s=m.value.progressSubStatus;if(i==null)return[];const t=y.value.filter(p=>p.parent==i);return s&&t.findIndex(r=>r.value==s)==-1&&(m.value.progressSubStatus=""),t}),H=()=>{w.back()},M=()=>{J.get("/admin/progress-categories").then(i=>{const{data:s}=i.data;V.value=B(s.categories),y.value=B(s.sub_categories),d()})},d=()=>{J.get(`/campaign-detail/${g}`).then(i=>{const{campaign_detail:s}=i.data,t=V.value.find(r=>r.title==s.progressStatus),p=y.value.find(r=>r.title==s.progressSubStatus);m.value={...s,progressStatus:t==null?"":t.value,progressSubStatus:p==null?"":p.value}})},o=async()=>{let{progressStatus:i,progressSubStatus:s,campaignAgentRemark:t}=m.value;if(!i||i==""){U.value="Progress Status must not be empty!";return}if(!s||s==""){U.value="Progress Sub Status must not be empty!";return}i=V.value.find(p=>p.value==i).title,s=I.value.find(p=>p.value==s).title;try{const p=await J.put(`/campaign-detail/${g}/status`,{progressStatus:i,progressSubStatus:s,campaignAgentRemark:t}),{status:r}=p.data;r=="success"&&(S.value=!0),setTimeout(()=>{H()},500)}catch(p){console.error("Error occurred:",p)}},c=i=>{l.value=!1,m.value.ref_no=i,J.put(`/campaign-detail/${g}/ref-number`,{ref_no:i}).then(s=>{const{status:t}=s.data;t=="success"&&(S.value=!0)})};return le(()=>{M()}),(i,s)=>{const t=pe,p=na;return L(),K(ge,null,{default:n(()=>[e(aa,null,{append:n(()=>[e(O,{class:"mr-4 my-4",color:"error",onClick:H},{default:n(()=>[C(" Back to Main ")]),_:1}),e(O,{onClick:F},{default:n(()=>[C(" Submit ")]),_:1})]),default:n(()=>[e(ea,null,{default:n(()=>[C("Campaign Detail")]),_:1})]),_:1}),e(Q,{class:"pl-8"},{default:n(()=>[e(_,null,{default:n(()=>[e(f,{cols:"12"},{default:n(()=>[$("div",ra,[ia,C(),$("span",da," #"+j(a(m).id),1),ma,C(),$("span",ca," #"+j(a(m).ref_no),1)])]),_:1})]),_:1}),e(_,null,{default:n(()=>[a(m)!=null?(L(!0),me(q,{key:0},fe(a(h),(r,x)=>(L(),K(f,{cols:"4",key:x,class:"d-flex justify-between"},{default:n(()=>[$("div",fa,j(r.title)+":",1),$("div",null,j(a(m)[r.key]||"--"),1)]),_:2},1024))),128)):ce("",!0)]),_:1}),e(la,{class:"my-6"}),e(_,null,{default:n(()=>[e(f,{cols:"12"},{default:n(()=>[pa]),_:1})]),_:1}),e(_,null,{default:n(()=>[e(f,{cols:"6"},{default:n(()=>[e(t,{modelValue:a(m).progressStatus,"onUpdate:modelValue":s[0]||(s[0]=r=>a(m).progressStatus=r),items:a(V),label:"Progress Status"},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"6"},{default:n(()=>[e(t,{modelValue:a(m).progressSubStatus,"onUpdate:modelValue":s[1]||(s[1]=r=>a(m).progressSubStatus=r),items:a(I),label:"Progress Sub Status"},null,8,["modelValue","items"])]),_:1}),e(f,{cols:"12"},{default:n(()=>[e(p,{modelValue:a(m).campaignAgentRemark,"onUpdate:modelValue":s[2]||(s[2]=r=>a(m).campaignAgentRemark=r),label:"Campaign Agent Remark"},null,8,["modelValue"])]),_:1})]),_:1}),e(Q,{class:"d-flex justify-end flex-wrap gap-3"},{default:n(()=>[e(O,{onClick:o},{default:n(()=>[C(" Update ")]),_:1})]),_:1}),e(te,{modelValue:a(R),"onUpdate:modelValue":s[3]||(s[3]=r=>Y(R)?R.value=r:null),timeout:1e3,location:"top end",color:"error"},{default:n(()=>[C(j(a(U)),1)]),_:1},8,["modelValue"]),e(te,{modelValue:a(S),"onUpdate:modelValue":s[4]||(s[4]=r=>Y(S)?S.value=r:null),timeout:1e3,location:"top end",color:"success"},{default:n(()=>[C(" Status has been successfully updated. ")]),_:1},8,["modelValue"])]),_:1}),e(ua,{isDialogVisible:a(l),onCloseDialog:N,onUpdateRecord:c},null,8,["isDialogVisible"])]),_:1})}}};export{Aa as default};
