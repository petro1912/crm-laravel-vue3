import{m as Se,b as Ce,u as ke,c as ne,f as ye,d as De,e as he,a as Re}from"./VTextField-bfab999d.js";import{N as Pe,Q as we,G as N,j as g,a2 as le,D as H,ac as Ue,S as Ie,a6 as $e,n as e,H as ee,F as q,I as ue,ad as Ne,ae as Ae,a7 as te,a8 as Fe,af as Be,ag as He,d as Me,ah as re,o as j,c as ce,p as t,b as K,A as me,aa as Te,a as fe,w as s,m as je,ai as ie,aj as de,q as ze,a1 as Le,L as J,C as k,E as Q,x as T,l as $,s as Ge,ak as Ee}from"./main-08db9eca.js";import{I as Je}from"./VImg-c259e2b4.js";import{f as Oe}from"./forwardRefs-7b02b8f0.js";import{_ as pe}from"./AppSelect-ce85c25f.js";import{V as ae,_ as qe}from"./VSnackbar-cbd6cf90.js";import{_ as Ke}from"./DialogCloseBtn-29845159.js";import{k as Qe,s as b,f as We}from"./auth-368f15e6.js";import{b as E,a as O}from"./axios-e8837589.js";import{V as ge,d as W,b as Xe,a as Ye}from"./VCard-4a2f6ead.js";import{V as y,a as p}from"./VRow-01833b0d.js";import{V as Ze}from"./VDialog-dc1b1272.js";import{V as et}from"./VDivider-4da7b810.js";import"./transition-6efa60be.js";import"./VSelect-c797c995.js";import"./VList-47c889fc.js";import"./VAvatar-f99f38b4.js";import"./VMenu-dc90384d.js";import"./VCheckboxBtn-777f44ee.js";const tt=Pe()({name:"VTextarea",directives:{Intersect:Je},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:a=>!isNaN(parseFloat(a))},maxRows:{type:[Number,String],validator:a=>!isNaN(parseFloat(a))},suffix:String,modelModifiers:Object,...Se(),...Ce()},emits:{"click:control":a=>!0,"mousedown:control":a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0},setup(a,R){let{attrs:D,emit:f,slots:c}=R;const o=we(a,"modelValue"),{isFocused:v,focus:h,blur:S}=ke(a),P=N(()=>typeof a.counterValue=="function"?a.counterValue(o.value):(o.value||"").toString().length),C=N(()=>{if(D.maxlength)return D.maxlength;if(!(!a.counter||typeof a.counter!="number"&&typeof a.counter!="string"))return a.counter});function A(r,_){var x,U;!a.autofocus||!r||(U=(x=_[0].target)==null?void 0:x.focus)==null||U.call(x)}const M=g(),I=g(),F=g(""),w=g(),z=N(()=>v.value||a.persistentPlaceholder);function B(){var r;w.value!==document.activeElement&&((r=w.value)==null||r.focus()),v.value||h()}function d(r){B(),f("click:control",r)}function l(r){f("mousedown:control",r)}function m(r){r.stopPropagation(),B(),te(()=>{o.value="",Fe(a["onClick:clear"],r)})}function i(r){var x;const _=r.target;if(o.value=_.value,(x=a.modelModifiers)!=null&&x.trim){const U=[_.selectionStart,_.selectionEnd];te(()=>{_.selectionStart=U[0],_.selectionEnd=U[1]})}}const u=g();function n(){a.autoGrow&&te(()=>{if(!u.value||!I.value)return;const r=getComputedStyle(u.value),_=getComputedStyle(I.value.$el),x=parseFloat(r.getPropertyValue("--v-field-padding-top"))+parseFloat(r.getPropertyValue("--v-input-padding-top"))+parseFloat(r.getPropertyValue("--v-field-padding-bottom")),U=u.value.scrollHeight,X=parseFloat(r.lineHeight),Y=Math.max(parseFloat(a.rows)*X+x,parseFloat(_.getPropertyValue("--v-input-control-height"))),Z=parseFloat(a.maxRows)*X+x||1/0;F.value=Be(He(U??0,Y,Z))})}le(n),H(o,n),H(()=>a.rows,n),H(()=>a.maxRows,n),H(()=>a.density,n);let V;return H(u,r=>{r?(V=new ResizeObserver(n),V.observe(u.value)):V==null||V.disconnect()}),Ue(()=>{V==null||V.disconnect()}),Ie(()=>{const r=!!(c.counter||a.counter||a.counterValue),_=!!(r||c.details),[x,U]=$e(D),[{modelValue:X,...Y}]=ne.filterProps(a),[Z]=ye(a);return e(ne,ee({ref:M,modelValue:o.value,"onUpdate:modelValue":L=>o.value=L,class:["v-textarea v-text-field",{"v-textarea--prefixed":a.prefix,"v-textarea--suffixed":a.suffix,"v-text-field--prefixed":a.prefix,"v-text-field--suffixed":a.suffix,"v-textarea--auto-grow":a.autoGrow,"v-textarea--no-resize":a.noResize||a.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(a.variant)},a.class],style:a.style},x,Y,{focused:v.value}),{...c,default:L=>{let{isDisabled:G,isDirty:oe,isReadonly:ve,isValid:Ve}=L;return e(De,ee({ref:I,style:{"--v-textarea-control-height":F.value},onClick:d,onMousedown:l,"onClick:clear":m,"onClick:prependInner":a["onClick:prependInner"],"onClick:appendInner":a["onClick:appendInner"],role:"textbox"},Z,{active:z.value||oe.value,dirty:oe.value||a.dirty,disabled:G.value,focused:v.value,error:Ve.value===!1}),{...c,default:be=>{let{props:{class:se,..._e}}=be;return e(q,null,[a.prefix&&e("span",{class:"v-text-field__prefix"},[a.prefix]),ue(e("textarea",ee({ref:w,class:se,value:o.value,onInput:i,autofocus:a.autofocus,readonly:ve.value,disabled:G.value,placeholder:a.placeholder,rows:a.rows,name:a.name,onFocus:B,onBlur:S},_e,U),null),[[Ne("intersect"),{handler:A},null,{once:!0}]]),a.autoGrow&&ue(e("textarea",{class:[se,"v-textarea__sizer"],"onUpdate:modelValue":xe=>o.value=xe,ref:u,readonly:!0,"aria-hidden":"true"},null),[[Ae,o.value]]),a.suffix&&e("span",{class:"v-text-field__suffix"},[a.suffix])])}})},details:_?L=>{var G;return e(q,null,[(G=c.details)==null?void 0:G.call(c,L),r&&e(q,null,[e("span",null,null),e(he,{active:a.persistentCounter||v.value,value:P.value,max:C.value},c.counter)])])}:void 0})}),Oe({},M,I,w)}}),at=Me({name:"AppTextarea",inheritAttrs:!1}),lt=Object.assign(at,{setup(a){const R=N(()=>{const f=re(),c=f.id||f.label;return c?`app-textarea-${c}-${Math.random().toString(36).slice(2,7)}`:void 0}),D=N(()=>re().label);return(f,c)=>(j(),ce("div",{class:ze(["app-textarea flex-grow-1",f.$attrs.class])},[t(D)?(j(),K(Re,{key:0,for:t(R),class:"mb-1 text-body-2 text-high-emphasis",text:t(D)},null,8,["for","text"])):me("",!0),e(tt,ie(de({...f.$attrs,class:null,label:void 0,variant:"outlined",id:t(R)})),Te({_:2},[fe(f.$slots,(o,v)=>({name:v,fn:s(h=>[je(f.$slots,v,ie(de(h||{})))])}))]),1040)],2))}}),ot={__name:"SubmitDialog",props:{isDialogVisible:{type:Boolean,required:!0}},emits:["close-dialog","update-record"],setup(a,{emit:R}){const D=a,f="https://ktic.com.my/api",c=Le(D,"isDialogVisible"),o=g(Qe),v=g([]),h=g([]),S=g([]),P=g([]),C=N(()=>A.value.length>0),A=g(""),M=()=>{R("close-dialog")};H(()=>o.value.product,(d,l)=>{d!=l&&z()},{deep:!0}),H(()=>o.value.state,(d,l)=>{d!=l&&F()},{deep:!0});const I=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1"};E.get(`${f}/api_state_list.php`,{params:d}).then(l=>{const m=l.data;m.error?v.value=[]:v.value=m.map(i=>i.state_name)})},F=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",state_name:o.value.state};E.get(`${f}/api_area_list.php`,{params:d}).then(l=>{const m=l.data;m.error?h.value=[]:h.value=m.map(i=>i.area)})},w=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1"};E.get(`${f}/api_available_products.php`,{params:d}).then(l=>{const m=l.data;m.error?S.value=[]:S.value=m.map(i=>i.product_name)})},z=()=>{const d={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",product_name:o.value.product};E.get(`${f}/api_available_package.php`,{params:d}).then(l=>{const m=l.data;m.error?P.value=[]:P.value=m.map(i=>i.package_name)})},B=()=>{const d=o.value;for(const m of Object.keys(d))if(console.log(m),d[m]==""||!d[m]){A.value=`'${b[m]}' must not be empty!`;return}const l={api_id:"SP202407CRM",api_token:"vdsas3DDVv12j4vNSCJ435fgdhghGDS890cvbH1",product_name:d.product,package_name:d.package,customer_name:d.fullname,nric:d.nric,citizen:d.citizen,address:`${d.address1} ${d.address2} ${d.address3}`,postcode:d.postcode,state_name:d.state,contact:d.contact,email:d.email,agentcode:d.agentcode};E.post(`${f}/casecrm_submitorder.php`,l).then(m=>{const i=m.data;console.log("res",m),R("update-record",i.ref_no)})};return le(()=>{I(),w()}),(d,l)=>{const m=Ke,i=pe,u=qe;return j(),K(Ze,{modelValue:t(c),"onUpdate:modelValue":l[16]||(l[16]=n=>Q(c)?c.value=n:null),persistent:"","max-width":"720"},{default:s(()=>[e(m,{onClick:M}),e(ge,{title:"Submit to KTIC"},{default:s(()=>[e(W,null,{default:s(()=>[e(y,{class:"mx-2"},{default:s(()=>[e(p,null,{default:s(()=>[e(i,{items:t(S),modelValue:t(o).product,"onUpdate:modelValue":l[0]||(l[0]=n=>t(o).product=n),label:t(b).product},null,8,["items","modelValue","label"])]),_:1}),e(p,null,{default:s(()=>[e(i,{items:t(P),modelValue:t(o).package,"onUpdate:modelValue":l[1]||(l[1]=n=>t(o).package=n),label:t(b).package},null,8,["items","modelValue","label"])]),_:1})]),_:1}),e(y,{class:"mx-2"},{default:s(()=>[e(p,null,{default:s(()=>[e(u,{modelValue:t(o).fullname,"onUpdate:modelValue":l[2]||(l[2]=n=>t(o).fullname=n),label:t(b).fullname},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:s(()=>[e(u,{modelValue:t(o).passportNo,"onUpdate:modelValue":l[3]||(l[3]=n=>t(o).passportNo=n),label:t(b).passportNo},null,8,["modelValue","label"])]),_:1})]),_:1}),e(y,{class:"mx-2"},{default:s(()=>[e(p,null,{default:s(()=>[e(i,{items:t(v),modelValue:t(o).state,"onUpdate:modelValue":l[4]||(l[4]=n=>t(o).state=n),label:t(b).state},null,8,["items","modelValue","label"])]),_:1}),e(p,null,{default:s(()=>[e(u,{modelValue:t(o).address1,"onUpdate:modelValue":l[5]||(l[5]=n=>t(o).address1=n),label:t(b).address1},null,8,["modelValue","label"])]),_:1})]),_:1}),e(y,{class:"mx-2"},{default:s(()=>[e(p,null,{default:s(()=>[e(i,{items:t(h),modelValue:t(o).area,"onUpdate:modelValue":l[6]||(l[6]=n=>t(o).area=n),label:t(b).area},null,8,["items","modelValue","label"])]),_:1}),e(p,null,{default:s(()=>[e(u,{modelValue:t(o).address2,"onUpdate:modelValue":l[7]||(l[7]=n=>t(o).address2=n),label:t(b).address2},null,8,["modelValue","label"])]),_:1})]),_:1}),e(y,{class:"mx-2"},{default:s(()=>[e(p,null,{default:s(()=>[e(u,{modelValue:t(o).postcode,"onUpdate:modelValue":l[8]||(l[8]=n=>t(o).postcode=n),label:t(b).postcode},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:s(()=>[e(u,{modelValue:t(o).address3,"onUpdate:modelValue":l[9]||(l[9]=n=>t(o).address3=n),label:t(b).address3},null,8,["modelValue","label"])]),_:1})]),_:1}),e(y,{class:"mx-2"},{default:s(()=>[e(p,null,{default:s(()=>[e(u,{modelValue:t(o).contact,"onUpdate:modelValue":l[10]||(l[10]=n=>t(o).contact=n),label:t(b).contact},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:s(()=>[e(u,{modelValue:t(o).email,"onUpdate:modelValue":l[11]||(l[11]=n=>t(o).email=n),label:t(b).email},null,8,["modelValue","label"])]),_:1})]),_:1}),e(y,{class:"mx-2"},{default:s(()=>[e(p,null,{default:s(()=>[e(u,{modelValue:t(o).citizen,"onUpdate:modelValue":l[12]||(l[12]=n=>t(o).citizen=n),label:t(b).citizen},null,8,["modelValue","label"])]),_:1}),e(p,null,{default:s(()=>[e(u,{modelValue:t(o).agentcode,"onUpdate:modelValue":l[13]||(l[13]=n=>t(o).agentcode=n),label:t(b).agentcode},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(W,{class:"d-flex justify-end flex-wrap gap-3"},{default:s(()=>[e(J,{variant:"tonal",color:"secondary",onClick:l[14]||(l[14]=n=>c.value=!1)},{default:s(()=>[k(" Close ")]),_:1}),e(J,{onClick:B},{default:s(()=>[k(" Submit ")]),_:1})]),_:1}),e(ae,{modelValue:t(C),"onUpdate:modelValue":l[15]||(l[15]=n=>Q(C)?C.value=n:null),timeout:1e3,location:"top end",color:"error"},{default:s(()=>[k(T(t(A)),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])}}},st={class:"font-italic"},nt=$("b",null,"Campaign Detail ID:",-1),ut={class:"ml-2 text-primary"},rt=$("b",null,"Campaign Reference Number:",-1),it={class:"ml-2 text-primary"},dt={class:"font-weight-bold text-sm"},ct=$("div",{class:"font-italic font-weight-bold"}," Update Status ",-1),It={__name:"[id]",props:{date_filter:{type:String,required:!1}},setup(a){const R=Ge(),D=Ee(),f=parseInt(D.params.id),c=g({}),o=g(!1),v=g([]),h=g([]),S=g(!1),P=N(()=>C.value.length>0),C=g(""),A=We.campaignDetail.filter(i=>i.key!="id"&&i.key!="campaignAgentRemark"),M=()=>{o.value=!0},I=()=>{o.value=!1},F=i=>i.map(u=>({value:u.id,title:u.name,parent:u.parent_id})),w=N(()=>{const i=c.value.progressStatus;return i==null?[]:h.value.filter(u=>u.parent==i)}),z=()=>{R.back()},B=()=>{O.get("/admin/progress-categories").then(i=>{const{data:u}=i.data;v.value=F(u.categories),h.value=F(u.sub_categories)})},d=()=>{O.get(`/campaign-detail/${f}`).then(i=>{const{campaign_detail:u}=i.data;c.value=u})},l=()=>{let{progressStatus:i,progressSubStatus:u,campaignAgentRemark:n}=c.value;if(!i||i==""){C.value="Progress Status must not be empty!";return}if(!u||u==""){C.value="Progress Sub Status must not be empty!";return}if(!n||n==""){C.value="Progress Sub Status must not be empty!";return}i=v.value.find(V=>V.value==i).title,u=w.value.find(V=>V.value==u).title,O.put(`/campaign-detail/${f}/status`,{progressStatus:i,progressSubStatus:u,campaignAgentRemark:n}).then(V=>{const{status:r}=V.data;r=="success"&&(S.value=!0)})},m=i=>{o.value=!1,O.put(`/campaign-detail/${f}/ref-number`,{ref_no:i}).then(u=>{const{status:n}=u.data;n=="success"&&(S.value=!0)})};return le(()=>{d(),B()}),(i,u)=>{const n=pe,V=lt;return j(),K(ge,null,{default:s(()=>[e(Ye,null,{append:s(()=>[e(J,{class:"mr-4 my-4",color:"error",onClick:z},{default:s(()=>[k(" Return ")]),_:1}),e(J,{onClick:M},{default:s(()=>[k(" Submit ")]),_:1})]),default:s(()=>[e(Xe,null,{default:s(()=>[k("Campaign Detail")]),_:1})]),_:1}),e(W,{class:"pl-8"},{default:s(()=>[e(y,null,{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[$("div",st,[nt,k(),$("span",ut," #"+T(t(c).id),1),rt,k(),$("span",it," #"+T(t(c).ref_no),1)])]),_:1})]),_:1}),e(y,null,{default:s(()=>[t(c)!=null?(j(!0),ce(q,{key:0},fe(t(A),(r,_)=>(j(),K(p,{cols:"4",key:_,class:"d-flex justify-between"},{default:s(()=>[$("div",dt,T(r.title)+":",1),$("div",null,T(t(c)[r.key]||"--"),1)]),_:2},1024))),128)):me("",!0)]),_:1}),e(et,{class:"my-6"}),e(y,null,{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[ct]),_:1})]),_:1}),e(y,null,{default:s(()=>[e(p,{cols:"6"},{default:s(()=>[e(n,{modelValue:t(c).progressStatus,"onUpdate:modelValue":u[0]||(u[0]=r=>t(c).progressStatus=r),items:t(v),label:"Progress Status"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"6"},{default:s(()=>[e(n,{modelValue:t(c).progressSubStatus,"onUpdate:modelValue":u[1]||(u[1]=r=>t(c).progressSubStatus=r),items:t(w),label:"Progress Sub Status"},null,8,["modelValue","items"])]),_:1}),e(p,{cols:"12"},{default:s(()=>[e(V,{modelValue:t(c).campaignAgentRemark,"onUpdate:modelValue":u[2]||(u[2]=r=>t(c).campaignAgentRemark=r),label:"Campaign Agent Remark"},null,8,["modelValue"])]),_:1})]),_:1}),e(W,{class:"d-flex justify-end flex-wrap gap-3"},{default:s(()=>[e(J,{onClick:l},{default:s(()=>[k(" Update ")]),_:1})]),_:1}),e(ae,{modelValue:t(P),"onUpdate:modelValue":u[3]||(u[3]=r=>Q(P)?P.value=r:null),timeout:1e3,location:"top end",color:"error"},{default:s(()=>[k(T(t(C)),1)]),_:1},8,["modelValue"]),e(ae,{modelValue:t(S),"onUpdate:modelValue":u[4]||(u[4]=r=>Q(S)?S.value=r:null),timeout:1e3,location:"top end",color:"error"},{default:s(()=>[k(" Status has been successfully updated. ")]),_:1},8,["modelValue"])]),_:1}),e(ot,{isDialogVisible:t(o),onCloseDialog:I,onUpdateRecord:m},null,8,["isDialogVisible"])]),_:1})}}};export{It as default};
