import{V as y,_ as j}from"./VSnackbar-058c891d.js";import{a as x,_ as z}from"./AvatarPicker-92e99cee.js";import{_ as R}from"./DialogCloseBtn-10ae58d1.js";import{c as h}from"./auth-149aec28.js";import{a as F}from"./axios-ae36d123.js";import{j as f,G,o as M,c as O,n as e,w as o,p as t,E as _,C as u,x as w,z as P,L as k,s as q}from"./main-61484bfe.js";import{V as U}from"./VBadge-70da9b1a.js";import{V as H}from"./VDialog-b69e3ed7.js";import{V as I}from"./VAvatar-08392dd6.js";import{V as L}from"./VImg-269a0fda.js";import{V as J}from"./VMenu-d32181aa.js";import{V as K,a as v,b as g,c as Q}from"./VList-3e5c49b3.js";import{V as W}from"./VListItemAction-580f4770.js";import{V as D}from"./VDivider-792f6d40.js";import{V as X,d as B}from"./VCard-eed1f9ea.js";import{V as Y,a as b}from"./VRow-44434673.js";import"./VTextField-a174cf70.js";import"./forwardRefs-6ee72851.js";import"./transition-a33c81e5.js";const ge={__name:"UserProfile",setup(Z){const S=q(),r=f(!1),n=f({current:"",update:"",confirm:""}),d=f(""),c=G(()=>d.value.length>0),i=f(!1),T=()=>{localStorage.clear(),S.replace("/login")},A=()=>{r.value=!0},E=()=>{r.value=!1},N=()=>{const l=n.value;if(l.current==""){m("Current Password must not be empty");return}else if(l.update==""){m("New Password must be not empty");return}else if(l.update!=l.confirm){m("Password confirmation doesn't match");return}F.post("/users/update-password",{password:l.current,new_password:l.update}).then(a=>{const{message:p}=a.data;p=="success"?(i.value=!0,r.value=!1):m(a.data.error)}).catch(a=>{d.value=a,r.value=!1})},m=l=>{d.value=l,setTimeout(()=>{d.value=""},2e3)},C=h();return(l,a)=>{const p=R,$=z,V=j;return M(),O("div",null,[e(U,{dot:"",location:"bottom right","offset-x":"3","offset-y":"3",bordered:"",color:"success"},{default:o(()=>[e(I,{class:"cursor-pointer",color:"primary",variant:"tonal"},{default:o(()=>[e(L,{src:t(x)},null,8,["src"]),e(J,{activator:"parent",width:"230",location:"bottom end",offset:"14px"},{default:o(()=>[e(K,null,{default:o(()=>[e(v,null,{prepend:o(()=>[e(W,{start:""},{default:o(()=>[e(U,{dot:"",location:"bottom right","offset-x":"3","offset-y":"3",color:"success"},{default:o(()=>[e(I,{color:"primary",variant:"tonal"},{default:o(()=>[e(L,{src:t(x)},null,8,["src"])]),_:1})]),_:1})]),_:1})]),default:o(()=>[e(g,{class:"font-weight-semibold"},{default:o(()=>[u(w(t(C).username),1)]),_:1}),e(Q,null,{default:o(()=>[u(w(t(C).role),1)]),_:1})]),_:1}),e(D,{class:"my-2"}),e(v,{onClick:A},{prepend:o(()=>[e(P,{class:"me-2",icon:"mdi-password",size:"22"})]),default:o(()=>[e(g,null,{default:o(()=>[u("Change Password")]),_:1})]),_:1}),e(D,{class:"my-2"}),e(v,{onClick:T},{prepend:o(()=>[e(P,{class:"me-2",icon:"tabler-logout",size:"22"})]),default:o(()=>[e(g,null,{default:o(()=>[u("Logout")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(H,{modelValue:t(r),"onUpdate:modelValue":a[4]||(a[4]=s=>_(r)?r.value=s:null),persistent:"","max-width":"420"},{default:o(()=>[e(p,{onClick:E}),e(X,{title:"User Profile"},{default:o(()=>[e(B,null,{default:o(()=>[e($),e(Y,{class:"mt-4"},{default:o(()=>[e(b,{cols:"12"},{default:o(()=>[e(V,{modelValue:t(n).current,"onUpdate:modelValue":a[0]||(a[0]=s=>t(n).current=s),label:"Current Password",type:"password"},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:o(()=>[e(V,{modelValue:t(n).update,"onUpdate:modelValue":a[1]||(a[1]=s=>t(n).update=s),label:"New Password",type:"password"},null,8,["modelValue"])]),_:1}),e(b,{cols:"12"},{default:o(()=>[e(V,{modelValue:t(n).confirm,"onUpdate:modelValue":a[2]||(a[2]=s=>t(n).confirm=s),label:"Password Confirm",type:"password"},null,8,["modelValue"])]),_:1}),e(B,{class:"d-flex justify-end flex-wrap gap-3"},{default:o(()=>[e(k,{variant:"tonal",color:"secondary",onClick:a[3]||(a[3]=s=>r.value=!1)},{default:o(()=>[u(" Close ")]),_:1}),e(k,{onClick:N},{default:o(()=>[u(" Update ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(y,{modelValue:t(c),"onUpdate:modelValue":a[5]||(a[5]=s=>_(c)?c.value=s:null),timeout:1e3,location:"top end",color:"error"},{default:o(()=>[u(w(t(d)),1)]),_:1},8,["modelValue"]),e(y,{modelValue:t(i),"onUpdate:modelValue":a[6]||(a[6]=s=>_(i)?i.value=s:null),timeout:1e3,location:"top end",color:"success"},{default:o(()=>[u(" Password has been successfully updated. ")]),_:1},8,["modelValue"])])}}};export{ge as default};
