import{_ as ue}from"./AppSelect-3c0d8978.js";import{V as ne,_ as re}from"./VSnackbar-003a0701.js";import{_ as de}from"./DialogCloseBtn-d556812b.js";import{r as ie,R as me,u as pe,d as L,b as ce,A as J,e as fe,t as Ve,f as ve}from"./auth-a813b017.js";import{a as k}from"./axios-4842e853.js";import{_ as _e}from"./AvatarPicker-aeb118e9.js";import{V as I,d as F,a as le,b as q,c as Q}from"./VCard-a1828138.js";import{V as ae,a as _}from"./VRow-ae45cd6e.js";import{j as v,a1 as W,G as X,a2 as se,o as A,b as S,w as l,n as e,p as a,A as G,E as R,L as w,C as c,x as K,l as E,c as ge,z as h,r as Ue}from"./main-e5b21e6b.js";import{V as H}from"./VDialog-655a0bf6.js";import{V as Y}from"./VTextField-cf3cb3b9.js";import{V as ee,a as Ce}from"./VSelect-46ecd8a5.js";import{V as be,a as we}from"./VPagination-a02ada5b.js";import{V as T}from"./VSpacer-3f1220e8.js";import"./forwardRefs-5c3acb7d.js";import"./transition-018643a2.js";import"./VBadge-5fb9488a.js";import"./VAvatar-c48175a6.js";import"./VImg-90c8631f.js";import"./VDivider-c47ed5c6.js";import"./VList-c0ee9fa3.js";import"./VMenu-5ca51ed5.js";import"./VCheckboxBtn-ee012881.js";const ye={__name:"CreateDialog",props:{isDialogVisible:{type:Boolean,required:!1},user:{type:Object,required:!1},isUpdate:{type:Boolean,required:!1}},emits:["close-dialog"],setup(O,{emit:D}){const f=O,g=ie(),r=pe,U=v([]),C=W(f,"isDialogVisible"),t=W(f,"user"),i=v(""),y=X(()=>p.value.length>0),x=X(()=>t.value.role==me),p=v(""),N=()=>{D("close-dialog",!1)},P=()=>setTimeout(()=>{p.value=""},1500),j=()=>{const m=t.value;if(console.log(m),m.username.length==0){p.value="Username must be not empty.",P();return}if(!/^[a-zA-Z0-9_]+$/.test(m.username)){p.value="Username must contain alphanumeric and underscore characters only.",P();return}if(m.role=="Agent"&&(m.team_leader==0||m.team_leader=="")){p.value="You must select team leader.";return}if(m.status!="active"&&m.status!="inactive"){p.value="Status is wrong.",P();return}if(!f.isUpdate&&m.password.length==0){p.value="Password must be not empty.",P();return}if(!f.isUpdate&&m.password!=i.value){p.value="Password mismatch.",P();return}f.isUpdate?k.put("/users",m).then(s=>{D("close-dialog",!0),t.value=L}).catch(s=>{s.response?(console.log(s.response.data),console.log(s.response.status),console.log(s.response.headers)):s.request?console.log(s.request):p.value=s.message}):k.post("/users",m).then(s=>{D("close-dialog",!0),t.value=L}).catch(s=>{s.response?(console.log(s.response.data),console.log(s.response.status),console.log(s.response.headers)):s.request?console.log(s.request):p.value=s.message})},z=()=>{k.get("/users/leaders").then(m=>{const{leaders:s}=m.data;U.value=s.map($=>({value:$.id,title:$.name}))})};return se(()=>{z()}),(m,s)=>{const $=de,b=re,B=ue;return A(),S(H,{modelValue:a(C),"onUpdate:modelValue":s[12]||(s[12]=n=>R(C)?C.value=n:null),persistent:"","max-width":"720"},{default:l(()=>[e($,{onClick:N}),e(I,{title:"User Profile"},{default:l(()=>[e(F,null,{default:l(()=>[e(_e),e(ae,{class:"mt-4"},{default:l(()=>[e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(b,{modelValue:a(t).username,"onUpdate:modelValue":s[0]||(s[0]=n=>a(t).username=n),label:"User Name"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(b,{modelValue:a(t).name,"onUpdate:modelValue":s[1]||(s[1]=n=>a(t).name=n),label:"Name"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(b,{modelValue:a(t).email,"onUpdate:modelValue":s[2]||(s[2]=n=>a(t).email=n),label:"Email","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(B,{modelValue:a(t).role,"onUpdate:modelValue":s[3]||(s[3]=n=>a(t).role=n),items:a(g),label:"Role"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[a(x)?(A(),S(B,{key:0,modelValue:a(t).team_leader,"onUpdate:modelValue":s[4]||(s[4]=n=>a(t).team_leader=n),items:a(U),label:"Team Leader"},null,8,["modelValue","items"])):G("",!0)]),_:1}),e(_,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(B,{modelValue:a(t).status,"onUpdate:modelValue":s[5]||(s[5]=n=>a(t).status=n),items:a(r),label:"Status"},null,8,["modelValue","items"])]),_:1}),f.isUpdate?G("",!0):(A(),S(_,{key:0,cols:"12",sm:"6"},{default:l(()=>[e(b,{modelValue:a(t).password,"onUpdate:modelValue":s[6]||(s[6]=n=>a(t).password=n),label:"Password",type:"password"},null,8,["modelValue"])]),_:1})),f.isUpdate?G("",!0):(A(),S(_,{key:1,cols:"12",sm:"6"},{default:l(()=>[e(b,{modelValue:a(i),"onUpdate:modelValue":s[7]||(s[7]=n=>R(i)?i.value=n:null),label:"Password Confirmation",type:"password"},null,8,["modelValue"])]),_:1})),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(b,{modelValue:a(t).caller_id,"onUpdate:modelValue":s[8]||(s[8]=n=>a(t).caller_id=n),label:"Caller ID",type:"number"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(b,{modelValue:a(t).contact_number,"onUpdate:modelValue":s[9]||(s[9]=n=>a(t).contact_number=n),label:"Contact Number",type:"text"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(F,{class:"d-flex justify-end flex-wrap gap-3"},{default:l(()=>[e(w,{variant:"tonal",color:"secondary",onClick:s[10]||(s[10]=n=>C.value=!1)},{default:l(()=>[c(" Close ")]),_:1}),e(w,{onClick:j},{default:l(()=>[c(" Save ")]),_:1})]),_:1})]),_:1}),e(ne,{modelValue:a(y),"onUpdate:modelValue":s[11]||(s[11]=n=>R(y)?y.value=n:null),timeout:1e3,location:"top end",color:"error"},{default:l(()=>[c(K(a(p)),1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},xe={class:"d-flex align-center mx-4"},ke={__name:"FilterUser",emits:["apply-filter"],setup(O,{emit:D}){const f=ce(),g=fe,r=v({id:"",name:"",role:J,status:J}),U=()=>{D("apply-filter",r.value)};return(C,t)=>(A(),S(I,null,{default:l(()=>[e(le,null,{default:l(()=>[e(q,null,{default:l(()=>[c("Filter ")]),_:1})]),_:1}),e(F,null,{default:l(()=>[E("div",xe,[e(Y,{modelValue:a(r).id,"onUpdate:modelValue":t[0]||(t[0]=i=>a(r).id=i),label:"Id"},null,8,["modelValue"]),e(Y,{class:"ml-4",modelValue:a(r).name,"onUpdate:modelValue":t[1]||(t[1]=i=>a(r).name=i),label:"Name"},null,8,["modelValue"]),e(ee,{class:"ml-4",modelValue:a(r).role,"onUpdate:modelValue":t[2]||(t[2]=i=>a(r).role=i),items:a(f),variant:"outlined",label:"Role"},null,8,["modelValue","items"]),e(ee,{class:"ml-4",modelValue:a(r).status,"onUpdate:modelValue":t[3]||(t[3]=i=>a(r).status=i),items:a(g),variant:"outlined",label:"Status"},null,8,["modelValue","items"]),e(w,{class:"ml-4",onClick:U},{default:l(()=>[c(" Apply ")]),_:1})])]),_:1})]),_:1}))}},De={class:"d-flex gap-1"},Pe=E("br",null,null,-1),$e=E("div",null,null,-1),Xe={__name:"index",setup(O){const D=ve.user,f=v([]),g=v([]),r=v(Ve),U=v(L),C=v(!1),t=v(!1),i=v(!1),y=v(-1),x=v(!1),p=v(-1),N=u=>u==="active"?{color:"success",text:u}:{color:"secondary",text:u},P=()=>{t.value=!0,C.value=!1,U.value=L},j=u=>{t.value=!1,U.value=L,u&&Z()},z=u=>{k.get(`/users/${u}`).then(o=>{const{user:V}=o.data;U.value=V,t.value=!0,C.value=!0})},m=u=>{i.value=!0,y.value=u},s=()=>{i.value=!1,y.value=-1},$=()=>{k.delete(`/users/${y.value}`).then(u=>{const{users:o}=u.data;f.value=o,g.value=o,i.value=!1,y.value=-1})},b=u=>{x.value=!0,p.value=u},B=()=>{x.value=!0,p.value=-1},n=()=>{k.put(`/users/${p.value}/reset-password`).then(u=>{x.value=!1,p.value=-1})},Z=()=>{k.get("/users").then(u=>{const{users:o}=u.data;f.value=o,g.value=o})},te=u=>{k.put(`/users/activate/${u}`).then(o=>{const{users:V}=o.data;f.value=V,g.value=V})},oe=u=>{let o=f.value;u.id!=""&&(o=o.filter(V=>V.id==u.id)),u.name!=""&&(o=o.filter(V=>V.username.includes(u.name))),u.role!="All"&&(o=o.filter(V=>V.role==u.role)),u.status!="All"&&(o=o.filter(V=>V.status==u.status)),g.value=[...o]};return se(()=>{Z()}),(u,o)=>{const V=Ue("IconBtn");return A(),ge("div",null,[e(ke,{onApplyFilter:oe}),e(I,{class:"mt-4"},{default:l(()=>[e(le,null,{append:l(()=>[e(w,{onClick:P,size:"small",icon:"tabler-plus"})]),default:l(()=>[e(q,null,{default:l(()=>[c("User List")]),_:1})]),_:1}),e(F,null,{default:l(()=>[e(a(be),{headers:a(D),items:a(g),"items-per-page":a(r).itemsPerPage,page:a(r).page,"onUpdate:options":o[2]||(o[2]=d=>r.value=d)},{"item.status":l(({item:d})=>[e(Ce,{color:N(d.raw.status).color,onClick:M=>te(d.raw.id),size:"small"},{default:l(()=>[c(K(N(d.raw.status).text),1)]),_:2},1032,["color","onClick"])]),"item.team_leader":l(({item:d})=>[c(K(d.raw.leader?d.raw.leader.name:""),1)]),"item.actions":l(({item:d})=>[E("div",De,[e(V,{onClick:M=>z(d.raw.id)},{default:l(()=>[e(h,{icon:"mdi-pencil-outline"})]),_:2},1032,["onClick"]),e(V,{onClick:M=>m(d.raw.id)},{default:l(()=>[e(h,{icon:"mdi-delete-outline"})]),_:2},1032,["onClick"]),e(w,{rounded:"",onClick:M=>b(d.raw.id)},{default:l(()=>[c(" Reset Password ")]),_:2},1032,["onClick"])])]),bottom:l(()=>[e(F,{class:"mt-8"},{default:l(()=>[e(ae,null,{default:l(()=>[e(_,{lg:"2",cols:"3"},{default:l(()=>[e(Y,{modelValue:a(r).itemsPerPage,"onUpdate:modelValue":o[0]||(o[0]=d=>a(r).itemsPerPage=d),label:"Rows per page:",type:"number",min:"-1",max:"15","hide-details":""},null,8,["modelValue"])]),_:1}),e(_,{lg:"10",cols:"9",class:"d-flex justify-end"},{default:l(()=>[e(we,{modelValue:a(r).page,"onUpdate:modelValue":o[1]||(o[1]=d=>a(r).page=d),"total-visible":"5",length:Math.ceil(a(f).length/a(r).itemsPerPage)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1},8,["headers","items","items-per-page","page"]),e(ye,{isDialogVisible:a(t),user:a(U),isUpdate:a(C),onCloseDialog:j},null,8,["isDialogVisible","user","isUpdate"]),e(H,{modelValue:a(i),"onUpdate:modelValue":o[3]||(o[3]=d=>R(i)?i.value=d:null),"max-width":"500px"},{default:l(()=>[e(I,null,{default:l(()=>[e(q,{class:"px-8 py-8"},{default:l(()=>[c(" Are you sure you want to delete this user? ")]),_:1}),e(Q,null,{default:l(()=>[e(T),e(w,{color:"error",variant:"outlined",onClick:s},{default:l(()=>[c(" Cancel ")]),_:1}),e(w,{color:"success",variant:"elevated",onClick:$},{default:l(()=>[c(" OK ")]),_:1}),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:a(x),"onUpdate:modelValue":o[4]||(o[4]=d=>R(x)?x.value=d:null),"max-width":"600px"},{default:l(()=>[e(I,null,{default:l(()=>[e(q,{class:"text-center px-8 py-8"},{default:l(()=>[c(" Are you sure you want to reset password"),Pe,c(" of this user (Password: 123456)? ")]),_:1}),$e,e(Q,null,{default:l(()=>[e(T),e(w,{color:"error",variant:"outlined",onClick:B},{default:l(()=>[c(" Cancel ")]),_:1}),e(w,{color:"success",variant:"elevated",onClick:n},{default:l(()=>[c(" OK ")]),_:1}),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])}}};export{Xe as default};
