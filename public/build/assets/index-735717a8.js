import{_ as De}from"./AppDateTimePicker-b68769a1.js";import{_ as ke}from"./AppSelect-c7883347.js";import{V as xe,_ as Se}from"./VSnackbar-bfdea7fe.js";import{_ as Ve}from"./DialogCloseBtn-b532f150.js";import{a as T}from"./axios-c835c00c.js";import{V as G,d as q,a as we,b as ce,c as Ie}from"./VCard-b32c692a.js";import{V as N,a as V}from"./VRow-4cca22a4.js";import{a as me,m as he,b as Ue,u as Pe,c as pe,f as $e,d as Be,e as Fe,V as Ae}from"./VTextField-93f4669b.js";import{a1 as H,G as P,j as f,a2 as ye,o as ue,b as Ce,w as a,n as e,p as t,C as x,L as F,E as A,x as J,N as Re,a3 as ze,a4 as Le,Q as Te,a5 as fe,D as je,S as Ne,a6 as qe,H as le,F as oe,a7 as Me,a8 as Ee,l as K,I as Oe,a9 as He,J as Ye,c as Ge,aa as Je,z as ne,r as ge}from"./main-b50d5463.js";import{V as re}from"./VDialog-b724fadf.js";import{f as Ke}from"./forwardRefs-147dc27a.js";import{a as be,V as se}from"./VSelect-0e8168f5.js";import{t as Qe,h as ve,i as We,j as Xe,f as Ze,A as ie}from"./auth-ec437199.js";import{V as ea,a as aa}from"./VPagination-5286fa5d.js";import{V as _e}from"./VSpacer-287a8bfd.js";import"./VAvatar-8d1777e9.js";import"./VImg-baea078e.js";import"./transition-a497af79.js";import"./VDivider-43ab8d07.js";import"./VList-efbd3225.js";import"./VMenu-bec20866.js";import"./VCheckboxBtn-3b1c30a5.js";const ta={__name:"CreateDialog",props:{isDialogVisible:{type:Boolean,required:!1},isUpdate:{type:Boolean,required:!0},campaign:{type:Object,required:!0},categories:{type:Array,required:!0},sub_categories:{type:Array,required:!0}},emits:["close-dialog"],setup(i,{emit:y}){const C=i,g=H(C,"isDialogVisible"),l=H(C,"campaign"),v=H(C,"categories"),p=H(C,"sub_categories"),S=P(()=>{const u=l.value.category;return p.value.filter(n=>n.parent==u)}),w=P(()=>m.value.length>0),m=f(""),_=()=>{y("close-dialog",!1)},b=()=>{const u=l.value;if(u.name.length==0){m.value="Campaign Name must be not empty.";return}if(u.company.length==0){m.value="Company must be not empty.";return}if(u.category.length==0){m.value="Category must be not empty.";return}if(u.sub_category.length==0){m.value="Sub Category must be not empty.";return}if(u.start_date.length==0){m.value="You must select start date.";return}if(u.end_date.length==0){m.value="You must select end date.";return}if(u.status!="active"&&u.status!="inactive"){m.value="Status is wrong.";return}u.start_date=new Date(u.start_date).toISOString().slice(0,19).replace("T"," "),u.end_date=new Date(u.end_date).toISOString().slice(0,19).replace("T"," "),u.category=v.value.find(n=>n.value==u.category).title,u.sub_category=p.value.find(n=>n.value==u.sub_category).title,C.isUpdate?T.put("/admin/campaigns",u).then(n=>{y("close-dialog",!0)}):T.post("/admin/campaigns",u).then(n=>{y("close-dialog",!0)})};return ye(()=>{v.length>0&&(l.value.category=v[0].value)}),(u,n)=>{const B=Ve,h=Se,U=ke,I=De;return ue(),Ce(re,{modelValue:t(g),"onUpdate:modelValue":n[9]||(n[9]=c=>A(g)?g.value=c:null),persistent:"","max-width":"720"},{default:a(()=>[e(B,{onClick:_}),e(G,{title:"Campaign Detail"},{default:a(()=>[e(q,{class:"px-8"},{default:a(()=>[e(N,{class:"mt-4"},{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).name,"onUpdate:modelValue":n[0]||(n[0]=c=>t(l).name=c),label:"Campaign Name"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).company,"onUpdate:modelValue":n[1]||(n[1]=c=>t(l).company=c),label:"Company"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(U,{modelValue:t(l).category,"onUpdate:modelValue":n[2]||(n[2]=c=>t(l).category=c),items:t(v),label:"Category"},null,8,["modelValue","items"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(U,{modelValue:t(l).sub_category,"onUpdate:modelValue":n[3]||(n[3]=c=>t(l).sub_category=c),items:t(S),label:"Sub Category"},null,8,["modelValue","items"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(me,{for:"start-date",class:"mb-1 text-body-2 text-high-emphasis"},{default:a(()=>[x(" Start Date ")]),_:1}),e(I,{id:"end-date",class:"mr-4",modelValue:t(l).start_date,"onUpdate:modelValue":n[4]||(n[4]=c=>t(l).start_date=c)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(me,{for:"end-date",class:"mb-1 text-body-2 text-high-emphasis"},{default:a(()=>[x(" End Date ")]),_:1}),e(I,{class:"mr-4",modelValue:t(l).end_date,"onUpdate:modelValue":n[5]||(n[5]=c=>t(l).end_date=c)},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).today_sales,"onUpdate:modelValue":n[6]||(n[6]=c=>t(l).today_sales=c),label:"Today Sales",type:"number"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(h,{modelValue:t(l).total_sales,"onUpdate:modelValue":n[7]||(n[7]=c=>t(l).total_sales=c),label:"Total Sales",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(q,{class:"d-flex justify-end flex-wrap gap-3"},{default:a(()=>[e(F,{variant:"tonal",color:"secondary",onClick:_},{default:a(()=>[x(" Close ")]),_:1}),e(F,{onClick:b},{default:a(()=>[x(" Save ")]),_:1})]),_:1})]),_:1}),e(xe,{modelValue:t(w),"onUpdate:modelValue":n[8]||(n[8]=c=>A(w)?w.value=c:null),timeout:1e3,location:"top end",color:"error"},{default:a(()=>[x(J(t(m)),1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}};const la=Re()({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,showSize:{type:[Boolean,Number],default:!1,validator:i=>typeof i=="boolean"||[1e3,1024].includes(i)},...he({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:i=>ze(i).every(y=>y!=null&&typeof y=="object")},...Ue({clearable:!0})},emits:{"click:control":i=>!0,"mousedown:control":i=>!0,"update:focused":i=>!0,"update:modelValue":i=>!0},setup(i,y){let{attrs:C,emit:g,slots:l}=y;const{t:v}=Le(),p=Te(i,"modelValue"),{isFocused:S,focus:w,blur:m}=Pe(i),_=P(()=>typeof i.showSize!="boolean"?i.showSize:void 0),b=P(()=>(p.value??[]).reduce((d,D)=>{let{size:R=0}=D;return d+R},0)),u=P(()=>fe(b.value,_.value)),n=P(()=>(p.value??[]).map(d=>{const{name:D="",size:R=0}=d;return i.showSize?`${D} (${fe(R,_.value)})`:D})),B=P(()=>{var D;const d=((D=p.value)==null?void 0:D.length)??0;return i.showSize?v(i.counterSizeString,d,u.value):v(i.counterString,d)}),h=f(),U=f(),I=f();function c(){var d;I.value!==document.activeElement&&((d=I.value)==null||d.focus()),S.value||w()}function Q(d){M(d)}function Y(d){g("mousedown:control",d)}function M(d){var D;(D=I.value)==null||D.click(),g("click:control",d)}function W(d){d.stopPropagation(),c(),Me(()=>{p.value=[],Ee(i["onClick:clear"],d)})}return je(p,d=>{(!Array.isArray(d)||!d.length)&&I.value&&(I.value.value="")}),Ne(()=>{const d=!!(l.counter||i.counter),D=!!(d||l.details),[R,X]=qe(C),[{modelValue:de,...Z}]=pe.filterProps(i),[ee]=$e(i);return e(pe,le({ref:h,modelValue:p.value,"onUpdate:modelValue":z=>p.value=z,class:["v-file-input",i.class],style:i.style,"onClick:prepend":Q},R,Z,{focused:S.value}),{...l,default:z=>{let{id:j,isDisabled:L,isDirty:E,isReadonly:ae,isValid:te}=z;return e(Be,le({ref:U,"prepend-icon":i.prependIcon,onMousedown:Y,onClick:M,"onClick:clear":W,"onClick:prependInner":i["onClick:prependInner"],"onClick:appendInner":i["onClick:appendInner"]},ee,{id:j.value,active:E.value||S.value,dirty:E.value,disabled:L.value,focused:S.value,error:te.value===!1}),{...l,default:r=>{var k;let{props:{class:s,...$}}=r;return e(oe,null,[e("input",le({ref:I,type:"file",readonly:ae.value,disabled:L.value,multiple:i.multiple,name:i.name,onClick:o=>{o.stopPropagation(),c()},onChange:o=>{if(!o.target)return;const O=o.target;p.value=[...O.files??[]]},onFocus:c,onBlur:m},$,X),null),e("div",{class:s},[!!((k=p.value)!=null&&k.length)&&(l.selection?l.selection({fileNames:n.value,totalBytes:b.value,totalBytesReadable:u.value}):i.chips?n.value.map(o=>e(be,{key:o,size:"small",color:i.color},{default:()=>[o]})):n.value.join(", "))])])}})},details:D?z=>{var j,L;return e(oe,null,[(j=l.details)==null?void 0:j.call(l,z),d&&e(oe,null,[e("span",null,null),e(Fe,{active:!!((L=p.value)!=null&&L.length),value:B.value},l.counter)])])}:void 0})}),Ke({},h,U,I)}}),oa=K("b",null,"Campaign: ",-1),na={class:"ml-2 text-success"},sa={__name:"ImportDialog",props:{isDialogVisible:{type:Boolean,required:!0},campaign:{type:Object,required:!0}},emits:["close-dialog"],setup(i,{emit:y}){const C=i,g=H(C,"isDialogVisible"),l=f(!1),v=f(null),p=()=>{y("close-dialog")},S=()=>{const m=C.campaign;if(!m.id)return;const _=v.value;if(_.length==0)return;l.value=!0;const b=new FormData;b.append("csv",_[0]),T.post(`/admin/campaigns/${m.id}/import`,b,{headers:{"Content-Type":"multipart/form-data"}}).then(u=>{w()}).catch(u=>{w()})},w=()=>{l.value=!1,p()};return(m,_)=>{const b=Ve;return ue(),Ce(re,{modelValue:t(g),"onUpdate:modelValue":_[1]||(_[1]=u=>A(g)?g.value=u:null),"max-width":"600"},{default:a(()=>[e(b,{onClick:p}),e(G,{title:"Import Campaign Detail Data"},{default:a(()=>[e(q,{class:"px-8"},{default:a(()=>[e(N,null,{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[oa,K("span",na,J(C.campaign.name),1)]),_:1})]),_:1}),e(N,{class:"mt-4"},{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(la,{accept:"text/csv",label:"Select Import File(csv)",multiple:!1,modelValue:t(v),"onUpdate:modelValue":_[0]||(_[0]=u=>A(v)?v.value=u:null)},null,8,["modelValue"])]),_:1})]),_:1}),Oe(e(N,{class:"mt-4"},{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(He,{indeterminate:"",color:"primary"})]),_:1})]),_:1},512),[[Ye,t(l)]])]),_:1}),e(q,{class:"d-flex justify-end flex-wrap gap-3"},{default:a(()=>[e(F,{variant:"tonal",color:"secondary",onClick:p},{default:a(()=>[x(" Close ")]),_:1}),e(F,{onClick:S},{default:a(()=>[x(" Import Data ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};const ia=K("div",{class:"mb-2"}," Filter: ",-1),ua={class:"d-flex gap-1"},$a={__name:"index",setup(i){const y=f([]),C=f([]),g=f(Qe),l=f(!1),v=f(!1),p=f(!1),S=f(!1),w=f(ve),m=f(),_=f(),b=f(),u=f([]),n=f([]),B=f(-1),h=f({}),U={value:-1,title:ie,parent:-1},I=P(()=>m.value==null?[]:n.value.filter(r=>r.parent==m.value)),c=P(()=>[U,...u.value]),Q=P(()=>(_.value=U.value,[U,...I.value])),Y=r=>r==="active"?{color:"primary",text:"Active"}:r==="inactive"?{color:"secondary",text:"Inactive"}:{color:"secondary",text:"Inactive"},M=r=>r.map(s=>({value:s.id,title:s.name,parent:s.parent_id})),W=r=>u.value.find(s=>s.value==r),d=r=>n.value.find(s=>s.value==r),D=()=>{l.value=!0,S.value=!1},R=r=>{l.value=!1,w.value=ve,r&&E()},X=r=>{w.value=r,l.value=!0,S.value=!0},de=r=>{v.value=!0,B.value=r},Z=()=>{v.value=!1,B.value=-1},ee=r=>{p.value=!0,h.value=r},z=()=>{p.value=!1},j=r=>{T.put(`/admin/campaigns/activate/${r}`).then(s=>{const{campaigns:$}=s.data;y.value=$,C.value=$})},L=()=>{T.delete(`/admin/campaigns/${B.value}`).then(r=>{const{campaigns:s}=r.data;y.value=s,v.value=!1,B.value=-1})},E=()=>{T.get("/admin/campaigns").then(r=>{const{campaigns:s}=r.data;y.value=s,C.value=s})},ae=()=>{T.get("/admin/campaign-categories").then(r=>{const{data:s}=r.data;u.value=M(s.categories),n.value=M(s.sub_categories),m.value=U.value,b.value=ie})},te=()=>{const r=m.value,s=_.value,$=b.value;let k=[...y.value];r!=-1&&(k=k.filter(o=>o.category==W(r).title),s!=-1&&(k=k.filter(o=>o.sub_category==d(s).title))),$!=ie&&(k=k.filter(o=>o.status==$)),C.value=k};return ye(()=>{ae(),E()}),(r,s)=>{const $=ge("RouterLink"),k=ge("IconBtn");return ue(),Ge("div",null,[e(G,null,{default:a(()=>[e(we,null,Je({default:a(()=>[e(ce,null,{default:a(()=>[x("Campaign List")]),_:1})]),_:2},[t(We)()?{name:"append",fn:a(()=>[e(F,{size:"small",icon:"tabler-plus",onClick:D})]),key:"0"}:void 0]),1024),e(q,null,{default:a(()=>[ia,e(N,{class:"mb-3 mx-4"},{default:a(()=>[e(V,null,{default:a(()=>[e(se,{items:t(c),modelValue:t(m),"onUpdate:modelValue":s[0]||(s[0]=o=>A(m)?m.value=o:null),label:"Category"},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:a(()=>[e(se,{items:t(Q),modelValue:t(_),"onUpdate:modelValue":s[1]||(s[1]=o=>A(_)?_.value=o:null),label:"Sub Category"},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:a(()=>[e(se,{items:t(Xe),modelValue:t(b),"onUpdate:modelValue":s[2]||(s[2]=o=>A(b)?b.value=o:null),label:"Status"},null,8,["items","modelValue"])]),_:1}),e(V,null,{default:a(()=>[e(F,{block:"",onClick:te},{default:a(()=>[x(" Apply ")]),_:1})]),_:1})]),_:1}),e(t(ea),{headers:t(Ze).campaign,items:t(C),"items-per-page":t(g).itemsPerPage,page:t(g).page,"onUpdate:options":s[5]||(s[5]=o=>g.value=o)},{"item.name":a(({item:o})=>[e($,{to:`/campaigns/${o.raw.id}`,class:"link d-flex align-center gap-x-3"},{default:a(()=>[x(J(o.raw.name),1)]),_:2},1032,["to"])]),"item.status":a(({item:o})=>[e(be,{color:Y(o.raw.status).color,onClick:O=>j(o.raw.id),class:"font-weight-medium",size:"small"},{default:a(()=>[x(J(Y(o.raw.status).text),1)]),_:2},1032,["color","onClick"])]),"item.actions":a(({item:o})=>[K("div",ua,[e(k,{onClick:O=>X(o.raw)},{default:a(()=>[e(ne,{icon:"mdi-pencil-outline"})]),_:2},1032,["onClick"]),e(k,{onClick:O=>ee(o.raw)},{default:a(()=>[e(ne,{icon:"tabler-arrow-big-up-lines"})]),_:2},1032,["onClick"]),e(k,{onClick:O=>de(o.raw.id)},{default:a(()=>[e(ne,{icon:"mdi-delete-outline"})]),_:2},1032,["onClick"])])]),bottom:a(()=>[e(q,{class:"mt-8"},{default:a(()=>[e(N,null,{default:a(()=>[e(V,{lg:"2",cols:"3"},{default:a(()=>[e(Ae,{modelValue:t(g).itemsPerPage,"onUpdate:modelValue":s[3]||(s[3]=o=>t(g).itemsPerPage=o),label:"Rows per page:",type:"number",min:"-1",max:"15","hide-details":""},null,8,["modelValue"])]),_:1}),e(V,{lg:"10",cols:"9",class:"d-flex justify-end"},{default:a(()=>[e(aa,{modelValue:t(g).page,"onUpdate:modelValue":s[4]||(s[4]=o=>t(g).page=o),"total-visible":"5",length:Math.ceil(t(y).length/t(g).itemsPerPage)},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1})]),_:1},8,["headers","items","items-per-page","page"])]),_:1})]),_:1}),e(ta,{isDialogVisible:t(l),campaign:t(w),categories:t(u),sub_categories:t(n),isUpdate:t(S),onCloseDialog:R},null,8,["isDialogVisible","campaign","categories","sub_categories","isUpdate"]),e(sa,{isDialogVisible:t(p),campaign:t(h),onCloseDialog:z},null,8,["isDialogVisible","campaign"]),e(re,{modelValue:t(v),"onUpdate:modelValue":s[6]||(s[6]=o=>A(v)?v.value=o:null),"max-width":"500px"},{default:a(()=>[e(G,null,{default:a(()=>[e(ce,{class:"px-8 py-8"},{default:a(()=>[x(" Are you sure you want to delete this campaign? ")]),_:1}),e(Ie,null,{default:a(()=>[e(_e),e(F,{color:"error",variant:"outlined",onClick:Z},{default:a(()=>[x(" Cancel ")]),_:1}),e(F,{color:"success",variant:"elevated",onClick:L},{default:a(()=>[x(" OK ")]),_:1}),e(_e)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{$a as default};
